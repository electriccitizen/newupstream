<!DOCTYPE html>
<html class="pl">
  <head>
    <title>Pattern Lab</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width" />

    <link rel="stylesheet" href="../../css/style.css?1573673286" media="all" />
    <link rel="stylesheet" href="../../css/pattern-scaffolding.css?1573673286" media="all" />
    <link rel="stylesheet" href="../../../../dist/style.css?1573673286" media="all" />
    <link rel="stylesheet" href="../../js/select2.min.css?1573673286" media="all" />
    <link rel="stylesheet" href="../../js/swipebox/src/css/swipebox.css?1573673286" media="all" />

    <!-- Begin Pattern Lab (Required for Pattern Lab to run properly) -->
    <!-- never cache patterns -->
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />

<link rel="stylesheet" href="../../styleguide/css/styleguide.min.css?1573673286" media="all">
<link rel="stylesheet" href="../../styleguide/css/prism-typeahead.min.css?1573673286" media="all" />
    <!-- End Pattern Lab -->

  </head>
  <body class="">
    <!-- for js not found errors (only in styleguide)-->
  	<div class="visually-hidden">
  		<div id="tabs" class="tabs"></div>
  	</div>
<!-- View All Patterns in a Pattern Sub-Type -->
<div class="sg-main" role="main">
  <!-- Patterns -->
  <div id="sg-patterns">
                  <div id="viewall-documentation-js" class="sg-subtype">
  <h2>
    <a href="../../patterns/documentation-07-js/index.html" class="patternLink" data-patternpartial="viewall-documentation-js">
      js
    </a>
  </h2>
  
  <div class="sg-pattern-body">
    
  </div>
</div>                        <div id="documentation-js-overview" class="sg-pattern">
  <div class="sg-pattern-head">
    <h3 class="sg-pattern-title">
      <a href="../../patterns/documentation-07-js-00-js-overview/documentation-07-js-00-js-overview.html" class="patternLink" data-patternpartial="documentation-js-overview" title="Link to Pattern">
        js overview
        
              </a>
    </h3>
    
    <div class="sg-pattern-breadcrumb">
      
    </div>
    
    <a href="#" data-patternpartial="documentation-js-overview" title="View Pattern Info" id="sg-pattern-extra-toggle-documentation-js-overview" class="sg-pattern-extra-toggle">
      <span>&#9660;</span>
    </a>
  </div>
  
  <div class="sg-pattern-extra" id="sg-pattern-extra-documentation-js-overview"></div>
    
  <div class="sg-pattern-example">
    <a name="js-overview" id="js-overview"></a>

<div class="doc-text">
	<div class="doc-section">
		<h4 class="doc-section-title">JS in PL and Drupal</h4>
		<div class="doc-section-inner">
			<p><strong>jQuery—</strong> jQuery is what we use to write 98% of the JS on a site. jQuery is a core Drupal dependency and all of the JS files in the theme are set up to use jQuery functions inside of Drupal behaviors.</p>
			<p>When adding a new file, its usually easiest to copy an existing theme JS file and just delete everything between the opening line: <span class="code">(function($, Drupal) {</span> and the  closing line: <span>})(jQuery, Drupal);</span>. Those two lines let Drupal know that it should use its core jQuery file to execute the behaviors inside the file. If you do create a new file from scratch or adding new behaviors to a file, make sure that everything is between those lines.</p>
			<p><strong><a name="drupal-behaviors" id="drupal-behaviors"></a>Drupal Behaviors—</strong> All jQuery functions in theme JS files need to be inside of <a href="https://www.drupal.org/node/304258#drupal-behaviors">Drupal Behaviors</a>. This ensures that all jQuery code gets called after the DOM has loaded so that you code is not jumping ahead of things it might need to function (like ajax). Drupal behaviors also comes with another line that attaches a context function. Using context ensures that your script is only searched within the given context rather than the entire document. <p>Example: <span class="code">Drupal.behaviors.slideshow = {<br>attach: function (context, settings) {<br>$(".paragraph--type--slideshow", context).once('slider').each(function(){ </span> <strong>Drupal behaviors and contexts should never be repeated.</strong> ANy duplicate behavior will not be called in the DOM.</p>
			<p>The above example opening lines of a behavior and context will search only instances of <span class="code">.paragraph--type--slideshow</span> and will only run the code once for each instance it finds in the DOM. Using context helps make sure that you are not slowing down the site by searching the whole DOM for elements that are not there and by ensuring that code is only run once, rather than looping through each instance and running multiple times. This is especially important with .resize() responsive functions.</p>
			<p><strong>Limit JS as much as possible—</strong> While JS is a powerful tool, Twig & CSS expressions/animations can do a lot of what we used to need JS for. It is preferable to use Twig or CSS whenever possible to both limit the amount of files being called as well as proofing again people who have JS turned off in their browser and errors from external scripts/applications interfering with your scripts.</p>
		</div>
	</div>
</div>


  </div>
  
  <script type="text/json" id="sg-pattern-data-documentation-js-overview" class="sg-pattern-data">
    {"lineage":[],"lineageR":[],"patternBreadcrumb":{"patternType":"documentation","patternSubtype":"js"},"patternDesc":"","patternExtension":"twig","patternName":"js overview","patternPartial":"documentation-js-overview","patternState":""}
  </script>
</div><!--end .sg-pattern-->                        <div id="documentation-global" class="sg-pattern">
  <div class="sg-pattern-head">
    <h3 class="sg-pattern-title">
      <a href="../../patterns/documentation-07-js-01-global/documentation-07-js-01-global.html" class="patternLink" data-patternpartial="documentation-global" title="Link to Pattern">
        global
        
              </a>
    </h3>
    
    <div class="sg-pattern-breadcrumb">
      
    </div>
    
    <a href="#" data-patternpartial="documentation-global" title="View Pattern Info" id="sg-pattern-extra-toggle-documentation-global" class="sg-pattern-extra-toggle">
      <span>&#9660;</span>
    </a>
  </div>
  
  <div class="sg-pattern-extra" id="sg-pattern-extra-documentation-global"></div>
    
  <div class="sg-pattern-example">
    <a name="js-global" id="js-global"></a>

<div class="doc-text">
	<div class="doc-section">
		<h4 class="doc-section-title">Global JS Custom Scripts</h4>
		<div class="doc-section-inner">
			<p><strong>global.js—</strong> Global.js is a file in 00-base/global.js that is run on every single page on the site. You can still limit when the scripts in it are used by taking advantage of behavior contexts, but the site still has to search for those contexts within the DOM.</p>
			<p>Global functions should only be things you know are going to be on every page—like custom scripts for the main navigation, or the scripts to run a fixed footer. Everything else should be in a <a href="#js-component">component JS file</a>.</p>
		</div>
	</div>
</div>

  </div>
  
  <script type="text/json" id="sg-pattern-data-documentation-global" class="sg-pattern-data">
    {"lineage":[],"lineageR":[],"patternBreadcrumb":{"patternType":"documentation","patternSubtype":"js"},"patternDesc":"","patternExtension":"twig","patternName":"global","patternPartial":"documentation-global","patternState":""}
  </script>
</div><!--end .sg-pattern-->                        <div id="documentation-component-js" class="sg-pattern">
  <div class="sg-pattern-head">
    <h3 class="sg-pattern-title">
      <a href="../../patterns/documentation-07-js-02-component-js/documentation-07-js-02-component-js.html" class="patternLink" data-patternpartial="documentation-component-js" title="Link to Pattern">
        component js
        
              </a>
    </h3>
    
    <div class="sg-pattern-breadcrumb">
      
    </div>
    
    <a href="#" data-patternpartial="documentation-component-js" title="View Pattern Info" id="sg-pattern-extra-toggle-documentation-component-js" class="sg-pattern-extra-toggle">
      <span>&#9660;</span>
    </a>
  </div>
  
  <div class="sg-pattern-extra" id="sg-pattern-extra-documentation-component-js"></div>
    
  <div class="sg-pattern-example">
    <a name="js-component" id="js-component"></a>

<div class="doc-text">
	<p>Attaching libraries, when to borrow libraries from other components</p>
	<div class="doc-section">
		<h4 class="doc-section-title">Component JS Files</h4>
		<div class="doc-section-inner">
						<p>Component JS files are files that are attached to the Twig template files for the components they relate to. This done through a library attachment Twig function. Each component will generally have its own JS file and library—with some exceptions:
				<ol>
					<li>Scripts that need external libraries (like Slick.js) should use the same library and be held in the same file to reduced the amount of calls to the external library.</li>
					<li>Components that very like on another but would benefit from different component folders (like a news by category and events by category) could share the same JS file and library.</li>
				</ol>
			</p>
			<p><strong>Attaching JS files to Twig—</strong> New JS files can be added to Drupal by attaching libraries. All JS files not hidden from PL will run in PL if the file is called in the meta/foot.twig file and the behavior is setup properly—the attach_library twig function is not available or needed in Pattern Lab. In most cases, you'll want to hide the new js file from PL with a leading _ and just use it in Drupal.</p>
			<p>After creating the new file, open <span class="code">citizen_patterns.libraries.yml</span> and add a new library following the existing conventions. Each library needs to have its dependencies listed along with any external libraries and css files needed. Don't worry about listing core dependencies in each library—they will not be called more than once if they are being called from other libraries loaded on the page.</p>
			<p>After creating your library, open the Drupal Twig file you are attaching it to (in /templates/zzz-custom) and use <span class="code">{{ attach_library(&#039;citizen_patterns/my_library&#039;) }}</span> Twig function to attach that library to the template. Libraries and that files they hold will only be called when that template is loaded (i.e. when the component is on the page). After attaching the library, clear cache and look for the library in the scripts section at the bottom of the page code just inside the closing body tag.</p>
		</div>
	</div>
</div>


  </div>
  
  <script type="text/json" id="sg-pattern-data-documentation-component-js" class="sg-pattern-data">
    {"lineage":[],"lineageR":[],"patternBreadcrumb":{"patternType":"documentation","patternSubtype":"js"},"patternDesc":"","patternExtension":"twig","patternName":"component js","patternPartial":"documentation-component-js","patternState":""}
  </script>
</div><!--end .sg-pattern-->                        <div id="documentation-es-linting" class="sg-pattern">
  <div class="sg-pattern-head">
    <h3 class="sg-pattern-title">
      <a href="../../patterns/documentation-07-js-03-es-linting/documentation-07-js-03-es-linting.html" class="patternLink" data-patternpartial="documentation-es-linting" title="Link to Pattern">
        es linting
        
              </a>
    </h3>
    
    <div class="sg-pattern-breadcrumb">
      
    </div>
    
    <a href="#" data-patternpartial="documentation-es-linting" title="View Pattern Info" id="sg-pattern-extra-toggle-documentation-es-linting" class="sg-pattern-extra-toggle">
      <span>&#9660;</span>
    </a>
  </div>
  
  <div class="sg-pattern-extra" id="sg-pattern-extra-documentation-es-linting"></div>
    
  <div class="sg-pattern-example">
    <a name="js-linting" id="js-linting"></a>

<div class="doc-text">
	<div class="doc-section">
		<h4 class="doc-section-title">JS Linting with ESLint</h4>
		<div class="doc-section-inner">
			<p>Citizen Patterns Emulsify Gulp dependency introduced <a href="https://eslint.org/" target="_blank">ESLint</a> to the project. ESLint behaves in much the same ways as StyleLint in that it checks your Javascript code for common errors and forces a level of consistency and good practice.</p>
			<p>The Emulsify Gulp repo brings ESLint in through the <span class="code">.eslintrc.yml</span>. This file extends the <a href="https://github.com/airbnb/javascript/tree/master/packages/eslint-config-airbnb-base/rules" target="_blank">airbnb-base rule library</a> and brings those rules into Citizen Patterns. The rules can overridden/altered by copying the <span class="code">.eslintrc.yml</span> into the Citizen Patterns base folder and written the changes you need.</p>
			<p>Unlike Stylelint, ESLint will shutdown the theme if it finds a broke rule. It will alert you through the command what rule is broken and where it is broken. Once you have fixed the rule, you must the run <span class="code">npm start</span> to spin up the theme again.</p>
		</div>
	</div>
</div>


  </div>
  
  <script type="text/json" id="sg-pattern-data-documentation-es-linting" class="sg-pattern-data">
    {"lineage":[],"lineageR":[],"patternBreadcrumb":{"patternType":"documentation","patternSubtype":"js"},"patternDesc":"","patternExtension":"twig","patternName":"es linting","patternPartial":"documentation-es-linting","patternState":""}
  </script>
</div><!--end .sg-pattern-->                        <div id="documentation-js-best-practices" class="sg-pattern">
  <div class="sg-pattern-head">
    <h3 class="sg-pattern-title">
      <a href="../../patterns/documentation-07-js-04-js-best-practices/documentation-07-js-04-js-best-practices.html" class="patternLink" data-patternpartial="documentation-js-best-practices" title="Link to Pattern">
        js best practices
        
              </a>
    </h3>
    
    <div class="sg-pattern-breadcrumb">
      
    </div>
    
    <a href="#" data-patternpartial="documentation-js-best-practices" title="View Pattern Info" id="sg-pattern-extra-toggle-documentation-js-best-practices" class="sg-pattern-extra-toggle">
      <span>&#9660;</span>
    </a>
  </div>
  
  <div class="sg-pattern-extra" id="sg-pattern-extra-documentation-js-best-practices"></div>
    
  <div class="sg-pattern-example">
    <a name="js-best-practices" id="js-best-practices"></a>

<div class="doc-text">
	<p>behaviors, context, only use if absolutely necessary—can do a lot through css & twig, always use as specifically as possible, some debugging practices.</p>
	<div class="doc-section">
		<h4 class="doc-section-title">JS Best Practices</h4>
		<div class="doc-section-inner">
			<ol class="big-number">
				<li>Always use jQuery functions inside of <a href="#drupal-behaviors">Drupal Behaviors</a> and contexts. <strong>Behaviors and Contexts should never be repeated.</strong> Any duplicate behavior will not be used.</li>
				<li>Use component JS files attached to Twig component templates in all cases except when you are sure the script is needed on every single page of the site.</li>
				<li>When an Citizen Patterns library calls an external script (call though CDN whenever possible, if that library is used for more than one component, do not create a new library/file for each component. This will reduce the amount of external calls.</li>
				<li><strong>Underscore JS—</strong> <a href="http://underscorejs.org/">UnderscoreJs</a> is an external library that is a Drupal Core dependency. OC Patterns uses it primarily for resize() responsive functions. <strong>Any time you need a function to be run each time the window is resized, use the Underscore <span class="code">._debounce() </span>function.</strong> Make sure that you specify core/underscore as a dependency of the library you create for that component.<br>Example:<br><span class="code">$(window).on('resize',  _.debounce( pageMenuMobile, 100 )).trigger('resize');</span><br> to call your custom:<br><span class="code">function pageMenuMobile({ scripts that happen on resize });</span>.</li>
				<li>Use descriptive (<span class="code">//my great js function does this...</span>) comments in JS files the same as you would for Scss. File name comments are not needed since these are individual attached rather than compiled into one sheet. Component level comments are not needed because of behavior names but are also not discouraged—especially when multiple components are added to the same JS file (like global.js).</li>
				<li><strong>Tabs—</strong> As with Scss files, Citizen Patterns uses tabs instead of spaces with a 3-space tab considered optimal (Sublime can be configured to do this for you automatically). Unfortunately there is no ESLint rule to enforce this.</li>
			</ol>
		</div>
	</div>
</div>


  </div>
  
  <script type="text/json" id="sg-pattern-data-documentation-js-best-practices" class="sg-pattern-data">
    {"lineage":[],"lineageR":[],"patternBreadcrumb":{"patternType":"documentation","patternSubtype":"js"},"patternDesc":"","patternExtension":"twig","patternName":"js best practices","patternPartial":"documentation-js-best-practices","patternState":""}
  </script>
</div><!--end .sg-pattern-->            </div> <!--end #sg-patterns-->
</div><!--end .sg-main-->
  <!--DO NOT REMOVE-->
  <script type="text/json" id="sg-pattern-data-footer" class="sg-pattern-data">
  {"patternPartial":"viewall-documentation-js"}
</script>

<script>
  /*!
  * scriptLoader - v0.1
  *
  * Copyright (c) 2014 Dave Olsen, http://dmolsen.com
  * Licensed under the MIT license
  *
  */
  
  var scriptLoader = {
    run: function(js,cb,target) {
      var s  = document.getElementById(target+'-'+cb);
      for (var i = 0; i < js.length; i++) {
        var src = (typeof js[i] != 'string') ? js[i].src : js[i];
        var c   = document.createElement('script');
        c.src   = '../../'+src+'?'+cb;
        if (typeof js[i] != 'string') {
          if (js[i].dep !== undefined) {
            c.onload = function(dep,cb,target) {
              return function() {
                scriptLoader.run(dep,cb,target);
              }
            }(js[i].dep,cb,target);
          }
        }
        s.parentNode.insertBefore(c,s);
      }
    }
  }
</script>

<script id="pl-js-polyfill-insert-1573673286">
  (function() {
    if (self != top) {
      var cb = '1573673286';
      var js = [];
      if (typeof document !== 'undefined' && !('classList' in document.documentElement)) {
        js.push('styleguide/bower_components/classList.min.js');
      }
      scriptLoader.run(js,cb,'pl-js-polyfill-insert');
    }
  })();
</script>

<script id="pl-js-insert-1573673286">
  (function() {
    if (self != top) {
      var cb = '1573673286';
      var js = [ { 'src': 'styleguide/bower_components/jwerty.min.js', 'dep': [ 'styleguide/js/patternlab-pattern.min.js' ] } ];
      scriptLoader.run(js,cb,'pl-js-insert');
    }
  })();
</script>

  <!-- Drupal-specific files - UNCOMMENT AS NECESSARY -->
  <!-- may need to change these below based on path -->
  <script src="../../js/ready.min.js"></script>
  <script src="../../js/drupal.js"></script>
  <script src="../../js/underscore-min.js"></script>
  <script src="../../js/jquery.js"></script>
  <script src="../../js/jquery.once.min.js"></script>
  <script src="../../js/select2.min.js"></script>
  <script src="../../js/stacktable/stacktable.min.js"></script>
  <script src="../../js/swipebox//src/js/jquery.swipebox.js"></script>
  <script src="../../../../dist/scripts-styleguide.js"></script>
  <script>Drupal.attachBehaviors();</script>
  <script>
    $("select").once('selects').each(function(){  
        $( '.sg-pattern-example select' ).select2({
          placeholder: "Select an option"
        });
    });
  </script>

  <script>
    $(".node--type-landing_page select").once('landing_select').each(function(){  
        $(this).select2();
    });
  </script>

  <script>
    $(".text-long table").once('stack').each(function(){  
        $(this).cardtable({myClass:'responsive-table'});
        $(document).ajaxComplete(function() {
            $('.layout-container table').cardtable({myClass:'responsive-table'});
        });
    });
  </script>
  </body>
</html>
